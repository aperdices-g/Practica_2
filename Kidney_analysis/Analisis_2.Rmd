---
title: "Práctica 2. Tipologia de Datos. Análisis y Visualización"
author: "Nuria García y Alicia Perdices"
date: '`r format(Sys.Date(),"%e de %B, %Y")`'
output:
  html_document: 
    toc: yes
    number_sections: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### **PRÁCTICA 2** 

##### ***0.-Librerias necesarias***
Abrimos las librerías necesarias para el buen funcionamiento de la práctica.

```{r}
library(readr)
```

##### ***1.-Descripción del dataset. ¿Por qué es importante y qué pregunta/problema pretende responder?***

El dataset objeto de estudio se ha obtenido a partir del siguiente enlace https://www.kaggle.com/mansoordaku/ckdisease en la web de Kaggle.Consta de 400 registros y 25 variables (25+Id) con información sobre pacientes del hospital Apollo en Tamil Nadu, estado del sur de la India, tanto con enfermedad renal crónica como no (determinados por el campo class).

La enfermedad renal crónica es un problema de salud global que crece constantemente, según nos indica el World Kidney Day (https://www.worldkidneyday.org/), actualmente afecta a 850 millones de personas, es decir, 1 de cada 10 adultos padecen esta enfermedad. El estudio de estos datos a través de la minería de datos puede ayudar a la detección precoz de dicha enfermedad (evitando una gravedad en el paciente), a realizar un mejor diagnóstico ayudando así a una mejor implementación de los tratamientos, y  en los gastos sanitarios (evitando la cronificación se reducen los gastos derivados de un empeoramiento de la enfermedad)*.

Por tanto, este conjunto de datos nos va a servir para predecir qué pacientes tienen más probabilidades de desarrollar una insuficiencia renal crónica a partir de parámetros como la edad, recuento de células en sangre (bioquímica básica) y ciertos aspectos como la presencia o no de diabetes, hipertensión, afecciones cardíacas etc.

El dataset se compone de los siguientes parámetros:

*	*Id*: (Numerical):Identificador
*	*Age* (Numerical): age in years
*	*bp* (Numerical): Blood presure(bp in mm/Hg)
*	*sp*: Specific Gravity(nominal).sg - (1.005,1.010,1.015,1.020,1.025)
*	*al*: Albumin(nominal):al - (0,1,2,3,4,5)
* *su*: Sugar(nominal):su - (0,1,2,3,4,5)
* *rbc*: Red Blood Cells(nominal):rbc - (normal,abnormal)
* *pc*: Pus Cell (nominal):pc - (normal,abnormal)
*	*pcc*: Pus Cell clumps(nominal):pcc - (present,notpresent)
*	*ba*: Bacteria(nominal):ba - (present,notpresent)
*	*bgr*: Blood Glucose Random(numerical):bgr in mgs/dl
*	*bu*: Blood Urea(numerical):bu in mgs/dl
*	*sc*: Serum Creatinine(numerical):sc in mgs/dl
*	*sod*: Sodium(numerical):sod in mEq/L
*	*pot*: Potassium(numerical):pot in mEq/L
*	*hemo*: Hemoglobin(numerical:hemo in gms
*	*pcv*: Packed Cell Volume(numerical)
*	*wc*: White Blood Cell Count(numerical):wc in cells/cumm
*	*rc*: Red Blood Cell Count(numerical):rc in millions/cmm
*	*htn*: Hypertension(nominal):htn - (yes,no)
*	*dm*: Diabetes Mellitus(nominal):dm - (yes,no)
*	*cad*: Coronary Artery Disease(nominal):cad - (yes,no)
*	*appet*: Appetite(nominal):appet - (good,poor)
*	*pe*: Pedal Edema(nominal):pe - (yes,no)
*	*ane*: Anemia(nominal):ane - (yes,no)
*	*classification*: Class (nominal):class - (ckd,notckd)


* Para más información del impacto del análisis de los datos en este tipo de datos recomendamos el artículo 'Informatics in Medicine Unlocked' (https://www.sciencedirect.com/science/article/pii/S2352914818302387)

##### ***2.-Integración y selección de los datos de interés a analizar***

Realizamos carga de los datos para su análisis (utilizamos el fichero kidney_disease_clean_2.csv que se ha obtenido en Kidey_disease_cleaning_2.Rmd después de la limpieza del fichero original):

```{r}
datos<-read.csv("data/kidney_disease_clean_2.csv",sep=",",header = TRUE)

```

Veamos la estructura de los datos cargados:

```{r}
str(datos)
```

Como ya se ha comentado partimos de 400 registros donde tenemos: 250 registros de pacientes con enfermedad renal crónica y 150 registros de pacientes que no presentan enfermedad renal.

```{r}
table(datos$classification)
```


Para poder deducir qué factores son los más determinantes a la hora de desarrollar una enfermedad como la insuficiencia renal crónica, contaremos con todos los atributos del dataset una vez completada la fase de limpieza correspondiente.Tan solo prescindiremos del campo Id que es simplemente identificativo del registro y no nos aporta información al estudio.

##### ***3.-Limpieza de datos***

***3.1-¿Los datos contienen ceros o elementos vacios?¿Como gestionarías cada uno de estos casos?***
  
  Todos los atributos del dataset, contienen elementos vacíos. La cantidad de valores nulos identificados en los campos es el siguiente:
  
  *	*Id*: No presenta valores nulos ni vacíos.
  *	*Age*: 9 valores nulos.
  *	*bp*: 12 valores nulos.
  *	*sp*: 47 valores vacíos.
  *	*al*: 46 valores vacíos.
  * *su*: 49 valores vacíos.
  * *rbc*: 152 valores vacíos.
  * *pc*: 65 valores vacíos.
  *	*pcc*: 4 valores vacíos.
  *	*ba*: 4 valores vacíos.
  *	*bgr*: 44 valores nulos.
  *	*bu*: 19 valores nulos.
  *	*sc*: 17 valores nulos.
  *	*sod*: 87 valores nulos.
  *	*pot*: 88 valores nulos.
  *	*hemo*: 52 valores nulos.
  *	*pcv*: 71 valores nulos.
  *	*wc*: 106 valores nulos.
  *	*rc*: 131 valores nulos.
  *	*htn*: 2 valores vacíos.
  *	*dm*: 2 valores vacíos y 5 valores mal identificados.
  *	*cad*: 2 valores vacíos y 2 valores mal identificados.
  *	*appet*: 1 valor vacío.
  *	*pe*: 1 valor vacío.
  *	*ane*: 1 valor vacío.
  *	*classification*: 2 valores mal identificados.
  
  
* En primer lugar, se ha transformado los valores de todas las columnas al tipo de datos correcto, además de corregir las categorías establecidas en las variables cualitativas.
  
* Los elementos vacíos se han gestionado de dos formas
    
    * **Método 1**.Para las variables categóricas, se han sustituido por la clase más frecuente. Y para las variables numéricas,  por la media del atributo en cuestión. Al final del proceso, hemos  obtenido el archivo **kidney_disease_clean_1.csv.(Kidey_disease_cleaning.Rmd)**
    
    * **Método 2**.Para las variables categóricas, se han sustituido por la clase más frecuente al igual que en el método anterior. Pero en este caso, para los elemenos vacíos de las variables numéricas, se ha utilizado el algoritmo KNN, de los vecinos más cercanos, para imputar estos valores.Al final del proceso, se ha obtenido el archivo **kidney_disease_clean_2.csv. (Kidey_disease_cleaning_2.Rmd)**
  


***3.2-Identificación y tratamiento de valores extremos***

Los valores extremos se han identificado mediante diagramas de cajas.(Kidey_disease_cleaning.Rmd).
Estos valores son muy importantes conservarlos, ya que en este caso pueden condicionar que una enfermedad renal crónica sea diagnosticada correctamente o no.

**DIAGRAMAS DE CAJAS**

```{r}
par(mfrow=c(1,2))
boxplot(datos$bp,main='Blood Pressure')
boxplot(datos$bgr,main='Blood Glucose Random')

par(mfrow=c(1,2))
boxplot(datos$sc,main='Serum Creatinine')
boxplot(datos$sod,main='Sodium')

par(mfrow=c(1,2))
boxplot(datos$pot,main='Potassium')
boxplot(datos$hemo,main='Hemoglobin')

par(mfrow=c(1,2))
boxplot(datos$pcv,main='Packed Cell Volume')
boxplot(datos$wc,main='White Blood Cell')

par(mfrow=c(1,2))
boxplot(datos$rc,main='Red Blood Cell Count')
boxplot(datos$bu,main='Blood Urea')
summary(datos)
```

Tras el estudio de los diagramas de cajas, observamos:

  * La mayoría de los pacientes tienen una tensión arterial normal.
  * Aproximadamente el 50% de los registros cuentan con valores de glucosa entre 100-150 unidades.
  * Como media los iones de sodio y potasio están en rango.
  * La creatinina muestra en varios registros valores fuera de rango, teniendo 3.072 unidades de media.
  * Un tercio de los pacientes presentan, hipertensión y diabetes.
  * Un 80% de los pacientes, tiene buen apetito y menos del 10% tiene una efermedad cardio-vascular de base.
  
Veamos cuáles son los valores extremos de las variables objeto de estudio:

```{r}
values_bp<-boxplot.stats(datos$bp)$out
cat("Valores extremos de Blood Pressure :",toString(values_bp), "\n")

values_bgr<-boxplot.stats(datos$bgr)$out
cat("Valores extremos de Blood Glucose Random :",toString(values_bgr), "\n")

values_sc<-boxplot.stats(datos$sc)$out
cat("Valores extremos de Serum Creatinine :",toString(values_sc), "\n")

values_sod<-boxplot.stats(datos$sod)$out
cat("Valores extremos de Sodium :",toString(values_sod), "\n")

values_pot<-boxplot.stats(datos$pot)$out
cat("Valores extremos de Potassium :",toString(values_pot), "\n")

values_hemo<-boxplot.stats(datos$hemo)$out
cat("Valores extremos de Hemoglobin :",toString(values_hemo), "\n")

values_pcv<-boxplot.stats(datos$pcv)$out
cat("Valores extremos de Packed Cell Volume :",toString(values_pcv), "\n")

values_wc<-boxplot.stats(datos$wc)$out
cat("Valores extremos de White Blood Cell :",toString(values_wc), "\n")

values_rc<-boxplot.stats(datos$rc)$out
cat("Valores extremos de Red Blood Cell Count :",toString(values_rc), "\n")

values_bu<-boxplot.stats(datos$bu)$out
cat("Valores extremos de Blood Urea :",toString(values_bu), "\n")
```

Como podemos observar en todos los campos tenemos valores extremos. Como se ha indicado anteriormente, no prescindiremos de ellos ya que pueden aportar información al estudio.

**HISTOGRAMAS**

```{r}
#HISTOGRAMAS
#=========================
par(mfrow=c(1,2))
hist(datos$bp,breaks=15,main='Blood Pressure')
hist(datos$bgr,breaks=15,main='Blood Glucose Random')

par(mfrow=c(1,2))
hist(datos$sc,breaks=15,main='Serum Creatinine')
hist(datos$sod,breaks=15,main='Sodium')

par(mfrow=c(1,2))
hist(datos$pot,breaks=15,main='Potassium')
hist(datos$hemo,breaks=15,main='Hemoglobin')

par(mfrow=c(1,2))
hist(datos$pcv,breaks=15,main='Packed Cell Volume')
hist(datos$wc,breaks=15,main='White Blood Cell')

par(mfrow=c(1,2))
hist(datos$rc,breaks=15,main='Red Blood Cell Count')
hist(datos$bu,breaks=15,main='Blood Urea')



```

Comprobamos cómo se distribuyen los valores de los distintos atributos, y observamos que solo parte de los registros tienen valores en un rango normal. El estudio sobre ellos y sus combinaciones nos va a posibilitar clasificar a un paciente con insuficiencia renal crónica.

**DIAGRAMAS DE BARRAS. vARIABLES CATEGÓRICAS**

```{r}

par(mfrow=c(1,2))
#Specific Gravity
###################

datos$sg<-as.factor(datos$sg)
plot(datos$sg, main="Specific Gravity", ylab="Frecuencia", col=c("gray","green"))
#Albumin
#############
datos$al<-as.factor(datos$al)
plot(datos$al, main="Albumin", ylab="Frecuencia", col=c("gray","pink"))


par(mfrow=c(1,2))
#Sugar
########

datos$su<-as.factor(datos$su)
plot(datos$su, main="Sugar", ylab="Frecuencia", col=c("gray","pink"))

#Red Blood Cells
################

datos$rbc<-as.factor(datos$rbc)
plot(datos$rbc, main="Red Blood Cells", ylab="Frecuencia", col=c("gray","green"))

par(mfrow=c(1,2))
#Pus Cell 
#########
plot(datos$pc, main="Pus Cell ", ylab="Frecuencia", col=c("gray","pink"))

#Pus Cell clumps
################
plot(datos$pcc, main="Pus Cell clumps ", ylab="Frecuencia", col=c("gray","green"))

par(mfrow=c(1,2))
#Bacteria 
#########
plot(datos$ba, main="Bacteria ", ylab="Frecuencia", col=c("gray","pink"))

#Hypertension
################
plot(datos$htn, main="Hypertension ", ylab="Frecuencia", col=c("gray","green"))


par(mfrow=c(1,2))
#Diabetes Mellitus
#########
plot(datos$dm, main="Diabetes Mellitus", ylab="Frecuencia", col=c("gray","pink"))

#Coronary Artery Disease
########################
plot(datos$cad, main="Coronary Artery Disease", ylab="Frecuencia", col=c("gray","green"))


par(mfrow=c(1,3))
#.Appetite
#########
plot(datos$appet, main="Appetite", ylab="Frecuencia", col=c("gray","pink"))

#Pedal Edema
############
plot(datos$pe, main="Pedal Edema", ylab="Frecuencia", col=c("gray","green"))

#Anemia
############
plot(datos$ane, main="Anemia", ylab="Frecuencia", col=c("gray","orange"))
```

Del análisis de los gráficos en relación a las variables cualitativas, observamos:

* Existe un número moderado (o alto) de pacientes con diabetes.
* Existe un número moderado (o alto) de pacientes con hipertensión.
* La mayoría de los pacientes no presentan enfermedades coronarias ni anemia.
* Gran parte de los pacientes aseguran tener buen apetito

##### ***4.-Análisis de datos***

***4.1-Selección de los grupos de datos que se quieren analizar/comparar (planificación de los análisis a aplicar).***

De entre todos los atributos recogidos en el dataset, los que a priori mejor describen una posible insuficiencia renal crónica es la **creatinina**, valores de la bioquímica básica, como puedan ser rango de iones **sodio-potasio**, y **hematocrito (glóbulos rojos)**. Todos estos valores combinados con los valores que muestran si el paciente tiene **diabetes** e **hipertensión** nos ayudarán a categorizar este tipo de insuficiencia.
Es decir, sabiendo que la creatinina es un valor/factor importante en el diagnóstico de la IRC, intentaremos buscar si existen relaciones o dependencias con los valores típicos de cualquier bioquímica habitual, para poder establecer patrones que sirvan para la detección precoz de la enfermedad.

Estudiaremos principalmente como se distribuyen estas variables para luego profundizar en el estudio y sus relaciones.

* Estadística inferencial de la creatinina para conocer mejor este factor determinante.
* Estudio sobre diferencia de medias (creatinina y diabetes). Intentaremos averiguar si la diabetes tiene un papel importante en los valores de creatinina de los pacientes. 
* Procederíamos de igual modo con la hipertensión regulada también por el riñon.
* Estudio sobre la anemia que es una variable que puede ayudarnos a diagnosticar de forma incipiente la IRC ya que es el riñon quien regula a través de la eritropoyetina la estimulación de eritrocitos o glóbulos rojos. Estimaremos en este caso modelos de regresión para profundizar en el estudio de la anemia y descubrir qué variables puedan estar más fuertemente relacionadas.





***4.2-Comprobación de la normalidad y homogeneidad de la varianza.***
Comprobemos si las variables Serum Creatinine (sc), Sodium (sod), Potassium (pot),Red Blood Cell Count(rc) se distribuyen normalmente.

**SERUM CREATININE (sc)**

Para comprobar si la variable 'sc' sigue una distribución normal, utilizaremos un test gráfico qqnorm, que dará como resultado una gráfica en la que si los puntos resultantes siguen una línea recta ascendente podremos asumir normalidad.

```{r}
par(mfrow=c(1,2))
plot(density(datos$sc),main="Density")
qqnorm(datos$sc)
```

Parece seguir una línea recta en un rango muy corto  en la parte central del gráfico, por lo que para poder asumir normalidad aplicaremos el test **Shapiro-Wilk Normality**. En este test se plantea como hipótesis nula que la muestra proviene de una población normalmente distribuida. Se rechazará la hipótesis nula si W que es el estadístico del test, es demasiado pequeño (oscila entre 0 y 1). Por otro lado si p-valor es menor que α, se rechazará la hipótesis nula, y los datos no seguirían una distribución normal.

```{r}
shapiro.test(datos$sc)
```

Como p-valor es menor que 0.05, no podemos asumir normalidad.

**SODIUM (sod)**
```{r}
par(mfrow=c(1,2))
plot(density(datos$sod),main="Density")
qqnorm(datos$sod)
shapiro.test(datos$sod)

```

Como p-valor es menor que 0.05, no podemos asumir normalidad.

**POTASSIUM (pot)**
```{r}
par(mfrow=c(1,2))
plot(density(datos$pot),main="Density")
qqnorm(datos$pot)
shapiro.test(datos$pot)

```

Como p-valor es menor que 0.05, no podemos asumir normalidad.


**RED BLOOD CELL Count(rc)**

```{r}
par(mfrow=c(1,2))
plot(density(datos$rc),main="Density")
qqnorm(datos$rc)
shapiro.test(datos$rc)
```

Como p-valor es menor que 0.05, no podemos asumir normalidad.

Por tanto, ninguna de las 3 variables estudiadas nos ha dado normalidad en los datos según el test de Saphiro-Wilk. De todas maneras, que nos haya salido esto no quiere decir que no puedan ser normalizables.Por el teorema del límite central, al tener más de 30 elementos (n > 30) en las observaciones, sea cual sea la distribución de la variable de interés, la distribución de la media muestral será aproximadamente una  normal. Así, podemos aproximar a la normalidad y asumir que tenemos normalidad.

Ahora vamos a comprobar la homocedasticidad en los datos, es decir, la igualdad de las varianzas. Aplicamos el test de Fligner-Killeen entre la hemoglobina y la hipertensión:

```{r}
fligner.test(hemo ~ htn, data = datos)
```

Obtenemos un p-value < 0.05, por tanto, se rechaza la hipótesis nula de homocedasticidad y se concluye que la variable hemo presenta varianzas estadísticamente diferentes grupos que tenemos en htn (es decir, pacientes hipertensos y pacientes no hipertensos).

***4.3-Aplicación de pruebas estadísticas para comparar grupos de datos.Aplicad tres métodos de análisis diferentes.***

**ESTADÍSTICA INFERENCIAL**

Teniendo en cuenta que un intervalo de confianza para un cierto parámetro con un nivel de confianza C%, es un intervalo calculado a partir de una muestra de manera que el procedimiento de cálculo garantiza que el C% de las muestras dan lugar a un intervalo que contiene el valor real del parámetro, procedemos a calcular el intervalo de confianza al 95% de la variable sc (serum creatinine) de los pacientes.

- Calculamos la media de la Creatinina
- La desviación típica
- Fijamos un nivel de confianza (1-$\alpha$)=95%
- Calculamos el error estándar: 
$$
s_x= \frac{s}{\sqrt{n}}
$$
- Calculamos el valor crítico que es el punto $t_{\alpha/2,n-1}$ tal que:

$$
P(t_{n-1}>=t_{\alpha/2,n-1})= \alpha/2
$$

- Calculamos el margen de error:

$$
t_{\alpha/2,n-1}{\frac{s}{\sqrt{n}}}
$$

- Siendo el intervalo de confianza:

$$
(\overline{x}-t_{\alpha/2,n-1}{\frac{s}{\sqrt{n}}},\overline{x}+t_{\alpha/2,n-1}{\frac{s}{\sqrt{n}}})
$$

```{r}
n<-nrow(datos)
me<-mean(datos$sc)
me
s<- sd(datos$sc)
s
t<-qt(0.025,399)
t
es<-s/sqrt(n)
es

i1=me-(t*es)
i2=me+(t*es) 
i1
i2

```

El intervalo de confianza sería **(2.4464,3.5532)**, siendo la media muestral de **2.9998**.

Verificamos con el t-test que hemos realizado bien los cálculos:

```{r}
tt<-t.test( datos$sc, conf.level=0.95 )
tt
```

Si repetimos en un número elevado de muestras el mismo procedimiento, el 95% de los intervalos encontrados contendrán el valor real de la media de la creatinina.

**CONTRASTE DE HIPOTESIS PARA LA DIFERENCIA DE MEDIAS**

Intentaremos dar respuesta a los siguientes interrogantes:
- ¿Podemos aceptar que los pacientes que tienen diabetes tienes la creatinina más alta que aquellos que no han desarrollado esta enfermedad?(Nivel de confianza del 95%). Aplicaremos un test de t Student. Veamos primero si podemos asumir igualdad de varianzas.

```{r}
sc_condm<- datos$sc[datos$dm=='yes']
sc_sindm<- datos$sc[datos$dm=='no']
var.test(sc_condm,sc_sindm)
```

Observamos un p-valor <0.05 por lo que rechazaríamos la hipotesis nula que implica que no podemos considerar varianzas iguales.

Por lo tanto tendremos que usar un test no paramétrico, el conocido cmo test U de Mann-Whitney que aplicado sobre muestras independientes nos permite comparar sus medias:

La hipótesis nula, $h_0$, recoge el hecho que queremos someter a prueba. Y la hipótesis alternativa, $h_1$, es la que se ofrece como alternativa a la nula.

- $h_0: \mu_1-\mu_2= 0$
- $h_1: \mu_1-\mu_2> 0$

```{r}
wilcox.test(datos$sc~datos$dm,alt="greater")
```

Como p-valor es mayor que 0.05 aceptamos la hipótesis nula, y por tanto no habría diferencias entre las medias de las creatininas de la población con diabetes en relación con aquellos pacientes que no han desarrollado la enfermedad.

**REGRESIÓN LINEAL**

Estudiaremos la relación entre distintas variables y la identificación de factores de riesgo asociados al desarrollo de una Insuficiencia Renal Crónica.
Vamos a estimar por mínimos cuadrados ordinarios un modelo lineal que explique la variable que indica el número de glóbulos rojos en función de la hemoglobina.

```{r}
#Estimacion del modelo

model<- lm(rc~hemo, data=datos)
summary(model)
```

A la vista de los resultados, existe una relación lineal positiva moderada, entre ambas variables. Se observa
que el coeficiente de determinación ajustado es: 0.6606 . Es decir, el **modelo explica el 66.06%** de la variabilidad de la variable hemoglobina.

La relación calculada anteriormente varía dependiendo de la nutrición de cada paciente.Haremos el mismo estudio dividiendo la muestra en 6 partes,1 para cada nivel de albúmina.(Cuanto más se aproxime a 5 el nivel de albúmina presentado, la nutrición del pacientwe será mejor).


```{r}
#Nivel 0
#########
al_0 <- which(datos$al==0 )
data_0=datos[al_0,]
dim(data_0)

#Nivel 1
#########
al_1 <- which(datos$al==1 )
data_1=datos[al_1,]
dim(data_1)

#Nivel 2
#########
al_2 <- which(datos$al==2 )
data_2=datos[al_2,]
dim(data_2)

#Nivel 3
#########
al_3 <- which(datos$al==3 )
data_3=datos[al_3,]
dim(data_3)

#Nivel 4
#########
al_4 <- which(datos$al==4 )
data_4=datos[al_4,]
dim(data_4)

#Nivel 5
#########
al_5 <- which(datos$al==5 )
data_5=datos[al_5,]
dim(data_5)

```


Estimamos un modelo para cada subconjunto:

```{r}
model_0<- lm(rc~hemo, data=data_0)
summary(model_0)

model_1<- lm(rc~hemo, data=data_1)
summary(model_1)

model_2<- lm(rc~hemo, data=data_2)
summary(model_2)

model_3<- lm(rc~hemo, data=data_3)
summary(model_3)

model_4<- lm(rc~hemo, data=data_4)
summary(model_4)

model_5<- lm(rc~hemo, data=data_5)
summary(model_5)
```

A la vista de los resultados, podemos concluir que la presencia o no de desnutrición influye ya que los coeficientes de determinación varían aunque se observan valores en torno al 60% en todos los casos. Se puede observar que la relación lineal en presencia de desnutrición (menor cantidad de albúmina) mejora.

##### ***5.-Representación de los resultados mediante gráficas y tablas.***

De entre las representaciones posibles, implementamos los diagramas de cajas de las variables que hemos comparado.

```{r}
par(mfrow=c(1,2))
boxplot(datos$hemo~datos$al, main="hemo~al")
boxplot(datos$rc~datos$al, main="rc~al")
```

Podemos comprobar las variaciones del hematocrito y el número de glóbulos rojos en relación a los diferentes estados de nutrición del paciente.


##### ***6.-Conclusiones.***

Tras el estudio realizado podemos concluir:

* Existe una relación lineal positiva moderada, entre las variables rc (glóbulos rojos) y la hemoglobina.
* La relación es más evidente cuando existe un grado de desnutrición en el paciente.
* No habría diferencias entre las medias de las creatininas de la población con diabetes en relación con aquellos pacientes que no han desarrollado la enfermedad.

